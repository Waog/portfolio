<div class="project-card no-page-break" [class.top-project]="isTopProject()">
  <aside class="order-controls screen-only">
    <button
      mat-icon-button
      color="primary"
      (click)="handleMoveUp()"
      class="move-up-btn"
      aria-label="Move project up"
    >
      <mat-icon>arrow_upward</mat-icon>
    </button>
    <span class="custom-index">{{ customIndex() }}</span>
    <button
      mat-icon-button
      color="primary"
      (click)="handleMoveDown()"
      class="move-down-btn"
      aria-label="Move project down"
    >
      <mat-icon>arrow_downward</mat-icon>
    </button>
  </aside>

  <header class="header-content">
    <h3 [class.compact]="compact()">{{ project().title }}</h3>
    <mat-chip color="accent" highlighted class="project-type-chip">
      {{ project().projectType }}
    </mat-chip>
  </header>
  <div>
    <!-- Compact Content (Collapsed State) -->
    <section *ngIf="!showExpandedContent" class="compact-content">
      <div class="compact-description">
        {{ project().compactDescription }}
      </div>
      <div class="key-achievements" [class.compact]="compact()">
        {{ project().keyAchievements }}
      </div>

      <nav class="content-toggle screen-only">
        <button
          mat-button
          color="primary"
          (click)="toggleContent()"
          class="expand-button"
        >
          <mat-icon>expand_more</mat-icon>
          Show Details
        </button>
      </nav>
    </section>

    <!-- Expanded Content (Full State) -->
    <section *ngIf="showExpandedContent" class="expanded-content">
      <div class="expanded-description">{{ project().fullDescription }}</div>

      <section class="features-section">
        <h4>Key Features</h4>
        <mat-list dense>
          <mat-list-item *ngFor="let feature of project().features">
            <mat-icon matListItemIcon color="primary">check</mat-icon>
            <div matListItemTitle>{{ feature }}</div>
          </mat-list-item>
        </mat-list>
      </section>

      <section class="highlights-section">
        <h4>Highlights</h4>
        <mat-list dense>
          <mat-list-item *ngFor="let highlight of project().highlights">
            <mat-icon matListItemIcon color="accent">star</mat-icon>
            <div matListItemTitle>
              {{ highlight }}
            </div>
          </mat-list-item>
        </mat-list>
      </section>

      <nav class="content-toggle">
        <button
          mat-button
          color="primary"
          (click)="toggleContent()"
          class="collapse-button"
        >
          <mat-icon>expand_less</mat-icon>
          Show Less
        </button>
      </nav>
    </section>

    <lib-project-item-meta-tiles
      [project]="project()"
      [compact]="compact() && !showExpandedContent"
    />

    <lib-keyword-list [keywordTags]="project().technologies" />
  </div>
</div>
